{"remainingRequest":"D:\\xiaomi\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\xiaomi\\vue\\src\\views\\Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\xiaomi\\vue\\src\\views\\Product.vue","mtime":1685089450856},{"path":"D:\\xiaomi\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xiaomi\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\xiaomi\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xiaomi\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7YmFzZVVSTH0gZnJvbSAiLi4vLi4vcHVibGljL3VybENvbmZpZyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiQC9yb3V0ZXIiOwppbXBvcnQgTmF2aSBmcm9tICIuLi9jb21wb25lbnRzL05hdmkiOwppbXBvcnQgUHJvZHVjdFBhcmFtcyBmcm9tICIuLi9jb21wb25lbnRzL1Byb2R1Y3RQYXJhbXMiOwppbXBvcnQgQ29tbWVudHMgZnJvbSAiLi4vY29tcG9uZW50cy9Db21tZW50cyI7CmxldCBza3VNYXBzPW5ldyBNYXAoKQpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlByb2R1Y3QiLAogIGNvbXBvbmVudHM6IHtQcm9kdWN0UGFyYW1zLCBOYXZpLENvbW1lbnRzfSwKICBkYXRhKCl7CiAgICByZXR1cm57CiAgICAgIHByb2R1Y3RJZDoiIiwKICAgICAgbnVtOjEsCiAgICAgIGN1cnJlbnRTa3VJbmRleDowLAogICAgICBjdXJyZW50SW1nSW5kZXg6MCwKICAgICAgdGFiOiBbXSwKICAgICAgdGFiUG9zaXRpb246IjAiLAogICAgICBwcm9kdWN0SW5mbzp7fSwKICAgICAgcHJvZHVjdFNrdTpbXSwKICAgICAgcHJvZHVjdEltZ3M6W10sCiAgICAgIHNrdVByb3BzOltdLAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIC8v6I635Y+W5YiwdXJs5Lyg6YCS55qE5ZWG5ZOBaWQKICAgIHRoaXMucHJvZHVjdElkPXRoaXMuJHJvdXRlLnF1ZXJ5LnBpZDsKICAgIHRoaXMubG9hZCgpOwogICAgdGhpcy5hZGRIaXN0b3J5KCk7CiAgICB2YXIgbGVuID0gMzsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgdmFyIGl0ZW0gPSB7dmFsdWU6ICIwIn07CiAgICAgIHRoaXMudGFiLnB1c2goaXRlbSk7CiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIGxvYWQoKXsKICAgICAgYXhpb3MuZ2V0KGJhc2VVUkwrIi9wcm9kdWN0cy9wcm9kdWN0LyIrdGhpcy5wcm9kdWN0SWQpLnRoZW4oCiAgICAgICAgICByZXM9PnsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0SW5mbz1yZXMuZGF0YS5kYXRhLnByb2R1Y3Q7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdFNrdT1yZXMuZGF0YS5kYXRhLnByb2R1Y3RTa3U7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdEltZ3M9cmVzLmRhdGEuZGF0YS5wcm9kdWN0SW1nczsKICAgICAgICAgICAgLy9ldmFs5bCGanNvbuagvOW8j+i9rOWMluS4uk1hcOmUruWAvOWvueagvOW8jwogICAgICAgICAgICB0aGlzLnNrdVByb3BzPWV2YWwoIigiK3RoaXMucHJvZHVjdFNrdVt0aGlzLmN1cnJlbnRTa3VJbmRleF0udW50aXRsZWQrIikiKTsKICAgICAgICAgIH0KICAgICAgKQogICAgfSwKICAgIHJlY3VyKGRhdGEpewogICAgICBmb3IobGV0IGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7CiAgICAgICAgZm9yIChsZXQgaj0wO2o8ZGF0YVtpXS5kaXN0cmljdHMubGVuZ3RoO2orKyl7CiAgICAgICAgICBmb3IgKGxldCBrPTA7azxkYXRhW2ldLmRpc3RyaWN0c1tqXS5kaXN0cmljdHMubGVuZ3RoO2srKyl7CiAgICAgICAgICAgIGRhdGFbaV0uZGlzdHJpY3RzW2pdLmRpc3RyaWN0c1trXS5kaXN0cmljdHM9dW5kZWZpbmVkCiAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZGF0YQogICAgfSwKICAgIGNoYW5nZVNrdSh2YWwpewogICAgICAgIHRoaXMuY3VycmVudFNrdUluZGV4PXZhbAogICAgICAvL2V2YWzlsIZqc29u5qC85byP6L2s5YyW5Li6TWFw6ZSu5YC85a+55qC85byPCiAgICAgIHRoaXMuc2t1UHJvcHM9ZXZhbCgiKCIrdGhpcy5wcm9kdWN0U2t1W3RoaXMuY3VycmVudFNrdUluZGV4XS51bnRpdGxlZCsiKSIpOwogICAgfSwKICAgIGNoYW5nZUltZyh2YWwpewogICAgICB0aGlzLmN1cnJlbnRJbWdJbmRleD12YWwKICAgIH0sCiAgICBjaGFuZ2VLZXkodmFsLGUpewogICAgICBza3VNYXBzLnNldChlLHZhbCkKICAgIH0sCiAgICBhZGRMaXN0KCl7CiAgICAgIHZhciBhPSIiCiAgICAgIGZvciAobGV0IGtleXMgb2Ygc2t1TWFwcy5rZXlzKCkpewogICAgICAgIGErPWtleXMrIjoiK3NrdU1hcHMuZ2V0KGtleXMpKyI7IjsKICAgICAgfQogICAgICB2YXIgY2FydHM9ewogICAgICAgICJjYXJ0TnVtIjp0aGlzLm51bSwKICAgICAgICAicHJvZHVjdElkIjp0aGlzLnByb2R1Y3RJZCwKICAgICAgICAicHJvZHVjdFByaWNlIjp0aGlzLnByb2R1Y3RTa3VbdGhpcy5jdXJyZW50U2t1SW5kZXhdLnNlbGxQcmljZSwKICAgICAgICAic2t1SWQiOnRoaXMucHJvZHVjdFNrdVt0aGlzLmN1cnJlbnRTa3VJbmRleF0uc2t1SWQsCiAgICAgICAgInNrdVByb3BzIjphLAogICAgICAgICJ1c2VySWQiOmxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySWQiKSwKICAgICAgfQogICAgICB2YXIgdG9rZW49bG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIikKICAgICAgYXhpb3MucG9zdChiYXNlVVJMKyIvc2hvcHBpbmctY2FydC9hZGQiLGNhcnRzLHtoZWFkZXJzOnsKICAgICAgICAgIHRva2VuOnRva2VufX0pLnRoZW4ocmVzPT57CiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlPT0xMDAwMCl7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihyZXMuZGF0YS5jb2RlPT0xMDAwMSl7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tc2cpCiAgICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgcGF0aDogJy9sb2dpbicsCiAgICAgICAgICAgICAgICBxdWVyeTp7CiAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiByb3V0ZXIuY3VycmVudFJvdXRlLmZ1bGxQYXRoICAvLyDpmLLmraLku47lpJbpg6jov5vmnaXnmbvlvZUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgfSwKICAgIHN1Ym1pdCgpewogICAgICB2YXIgYT0iIgogICAgICBmb3IgKGxldCBrZXlzIG9mIHNrdU1hcHMua2V5cygpKXsKICAgICAgICBhKz1rZXlzKyI6Iitza3VNYXBzLmdldChrZXlzKSsiOyI7CiAgICAgIH0KICAgICAgdmFyIGNhcnRzPXsKICAgICAgICAiY2FydE51bSI6dGhpcy5udW0sCiAgICAgICAgInByb2R1Y3RJZCI6dGhpcy5wcm9kdWN0SWQsCiAgICAgICAgInByb2R1Y3RQcmljZSI6dGhpcy5wcm9kdWN0U2t1W3RoaXMuY3VycmVudFNrdUluZGV4XS5zZWxsUHJpY2UsCiAgICAgICAgInNrdUlkIjp0aGlzLnByb2R1Y3RTa3VbdGhpcy5jdXJyZW50U2t1SW5kZXhdLnNrdUlkLAogICAgICAgICJza3VQcm9wcyI6YSwKICAgICAgICAidXNlcklkIjpsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcklkIiksCiAgICAgIH0KICAgICAgdmFyIHRva2VuPWxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgIGF4aW9zLnBvc3QoYmFzZVVSTCsiL3Nob3BwaW5nLWNhcnQvYWRkIixjYXJ0cyx7aGVhZGVyczp7CiAgICAgICAgICB0b2tlbjp0b2tlbn19KS50aGVuKHJlcz0+ewogICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZT09MTAwMDApewogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvb3JkZXI/Y2lkcz0iK3Jlcy5kYXRhLmRhdGEpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYocmVzLmRhdGEuY29kZT09MTAwMDEpIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICByb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICBwYXRoOiAnL2xvZ2luJywKICAgICAgICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiByb3V0ZXIuY3VycmVudFJvdXRlLmZ1bGxQYXRoICAvLyDpmLLmraLku47lpJbpg6jov5vmnaXnmbvlvZUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgYWRkSGlzdG9yeSgpewogICAgICB2YXIgaGlzdG9yeT17CiAgICAgICAgInByb2R1Y3RJZCI6dGhpcy5wcm9kdWN0SWQsCiAgICAgICAgInVzZXJJZCI6bG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJZCIpLAogICAgICB9CiAgICAgIGF4aW9zLnBvc3QoYmFzZVVSTCsiL2hpc3RvcnkvaW5zZXJ0IixoaXN0b3J5KQogICAgfSwKICB9LAogIG1vdW50ZWQoKXsKICAgIGNvbnNvbGUubG9nKHRoaXMucHJvZHVjdEltZ3MpCiAgfQoKfQo="},{"version":3,"sources":["Product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Product.vue","sourceRoot":"src/views","sourcesContent":["<template>\n<div style=\"overflow-x: hidden\">\n  <Navi/>\n  <el-row :gutter=\"20\" style=\"background-color: white;width: 80%;margin: 0 auto\">\n    <el-col :span=\"8\">\n      <el-col>\n        <el-image :src=\"require('@/img/'+productImgs[currentImgIndex].url)\" fit=\"fill\"\n                  :preview-src-list=\"['@/img'+productImgs[currentImgIndex].url]\"\n        style=\"height: 210px\"></el-image>\n      </el-col>\n      <el-col>\n        <el-carousel :autoplay=\"false\" type=\"card\" height=\"100px\" @change=\"changeImg\">\n          <el-carousel-item  v-for=\"item in productImgs\" >\n            <el-image :src=\"require('@/img/'+item.url)\" style=\"height: 100%;\"></el-image>\n          </el-carousel-item>\n        </el-carousel>\n      </el-col>\n    </el-col>\n    <el-col :span=\"16\">\n        <el-col>\n          <h3 style=\"float: left;margin: 5px\">{{productInfo.productName}}</h3>\n        </el-col>\n        <el-col style=\"background-color:#fee9eb\">\n          <el-col style=\"margin: 5px\">\n            <el-col :span=\"3\"style=\"text-align: left;font-size: 16px\">原价：</el-col>\n            <el-col :span=\"16\" style=\" text-align: left\">\n              <em style=\"font-size: 16px;text-decoration: line-through\">¥{{productSku[currentSkuIndex].originalPrice}}</em></el-col>\n          </el-col>\n          <el-col style=\"margin: 5px\">\n            <el-col :span=\"3\"style=\"text-align: left;font-size: 16px\">促销价：</el-col>\n            <el-col :span=\"16\" style=\" text-align: left;color: #c81623\">\n              <em style=\"font-size:30px;font-weight: 700;\">¥{{productSku[currentSkuIndex].sellPrice}}</em></el-col>\n          </el-col>\n        </el-col>\n        <el-col >\n          <span style=\"margin: 5px;float: left\" >套餐：</span>\n          <div style=\"margin: 5px;float: left\" v-for=\"(sku,index) in productSku\" >\n            <el-radio-group v-model=\"tabPosition\" size=\"medium\"  @change=\"changeSku\">\n              <el-radio-button :label=\"index\" >{{sku.skuName}}</el-radio-button>\n            </el-radio-group>\n          </div>\n        </el-col>\n        <el-col v-for=\"(value,key,index) in skuProps\" >\n          <span style=\"margin: 5px;float: left\" >{{ key }}：</span>\n          <div style=\"margin: 5px;float: left\" v-for=\"(sku) in value\">\n            <el-radio-group v-model=\"tab[index].value\" :key=\"key\" size=\"medium\" @change=\"(skus)=>changeKey(skus,key)\" >\n              <el-radio-button :label=\"sku\" >{{sku}}</el-radio-button>\n            </el-radio-group>\n          </div>\n        </el-col>\n        <el-col>\n          <el-descriptions size=\"medium\" style=\"text-align: left;font-size: 16px;margin: 5px\">\n            <el-descriptions-item label=\"库存：\">{{ productSku[currentSkuIndex].stock }}</el-descriptions-item>\n            <el-descriptions-item label=\"累计销量：\">{{productInfo.soldNum}}件</el-descriptions-item>\n          </el-descriptions>\n        </el-col>\n        <el-col>\n          <el-input-number v-model=\"num\"  :min=\"1\" :max=\"productSku[currentSkuIndex].stock\" label=\"描述文字\"\n          style=\"float: left;margin: 5px\"></el-input-number>\n          <el-button type=\"warning\" round plain style=\"margin: 5px;\" @click=\"addList\">添加购物车</el-button>\n          <el-button type=\"success\" round plain style=\"margin: 5px;\" @click=\"submit\">立即购买</el-button>\n        </el-col>\n    </el-col>\n  </el-row>\n  <el-tabs type=\"border-card\" style=\"margin: 0 auto;width: 80%\">\n    <el-tab-pane label=\"宝贝详情\"><ProductParams :productId=\"productId\" :productImgs=\"productImgs\"></ProductParams></el-tab-pane>\n    <el-tab-pane >\n      <span slot=\"label\"><i class=\"el-icon-chat-dot-square\"></i> 评价</span>\n      <Comments :productId=\"productId\"></Comments>\n    </el-tab-pane>\n  </el-tabs>\n</div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport {baseURL} from \"../../public/urlConfig\";\nimport router from \"@/router\";\nimport Navi from \"../components/Navi\";\nimport ProductParams from \"../components/ProductParams\";\nimport Comments from \"../components/Comments\";\nlet skuMaps=new Map()\nexport default {\n  name: \"Product\",\n  components: {ProductParams, Navi,Comments},\n  data(){\n    return{\n      productId:\"\",\n      num:1,\n      currentSkuIndex:0,\n      currentImgIndex:0,\n      tab: [],\n      tabPosition:\"0\",\n      productInfo:{},\n      productSku:[],\n      productImgs:[],\n      skuProps:[],\n    }\n  },\n  created() {\n    //获取到url传递的商品id\n    this.productId=this.$route.query.pid;\n    this.load();\n    this.addHistory();\n    var len = 3;\n    for (var i = 0; i < len; i++) {\n      var item = {value: \"0\"};\n      this.tab.push(item);\n    }\n  },\n  methods:{\n    load(){\n      axios.get(baseURL+\"/products/product/\"+this.productId).then(\n          res=>{\n            this.productInfo=res.data.data.product;\n            this.productSku=res.data.data.productSku;\n            this.productImgs=res.data.data.productImgs;\n            //eval将json格式转化为Map键值对格式\n            this.skuProps=eval(\"(\"+this.productSku[this.currentSkuIndex].untitled+\")\");\n          }\n      )\n    },\n    recur(data){\n      for(let i=0;i<data.length;i++){\n        for (let j=0;j<data[i].districts.length;j++){\n          for (let k=0;k<data[i].districts[j].districts.length;k++){\n            data[i].districts[j].districts[k].districts=undefined\n          }\n\n        }\n      }\n      return data\n    },\n    changeSku(val){\n        this.currentSkuIndex=val\n      //eval将json格式转化为Map键值对格式\n      this.skuProps=eval(\"(\"+this.productSku[this.currentSkuIndex].untitled+\")\");\n    },\n    changeImg(val){\n      this.currentImgIndex=val\n    },\n    changeKey(val,e){\n      skuMaps.set(e,val)\n    },\n    addList(){\n      var a=\"\"\n      for (let keys of skuMaps.keys()){\n        a+=keys+\":\"+skuMaps.get(keys)+\";\";\n      }\n      var carts={\n        \"cartNum\":this.num,\n        \"productId\":this.productId,\n        \"productPrice\":this.productSku[this.currentSkuIndex].sellPrice,\n        \"skuId\":this.productSku[this.currentSkuIndex].skuId,\n        \"skuProps\":a,\n        \"userId\":localStorage.getItem(\"userId\"),\n      }\n      var token=localStorage.getItem(\"token\")\n      axios.post(baseURL+\"/shopping-cart/add\",carts,{headers:{\n          token:token}}).then(res=>{\n            if (res.data.code==10000){\n              this.$message.success(res.data.msg)\n            }\n            if(res.data.code==10001){\n              this.$message.error(res.data.msg)\n              router.push({\n                path: '/login',\n                query:{\n                  redirect: router.currentRoute.fullPath  // 防止从外部进来登录\n                }\n              })\n            }\n          })\n    },\n    submit(){\n      var a=\"\"\n      for (let keys of skuMaps.keys()){\n        a+=keys+\":\"+skuMaps.get(keys)+\";\";\n      }\n      var carts={\n        \"cartNum\":this.num,\n        \"productId\":this.productId,\n        \"productPrice\":this.productSku[this.currentSkuIndex].sellPrice,\n        \"skuId\":this.productSku[this.currentSkuIndex].skuId,\n        \"skuProps\":a,\n        \"userId\":localStorage.getItem(\"userId\"),\n      }\n      var token=localStorage.getItem(\"token\")\n      axios.post(baseURL+\"/shopping-cart/add\",carts,{headers:{\n          token:token}}).then(res=>{\n            if (res.data.code==10000){\n              this.$router.push(\"/order?cids=\"+res.data.data)\n            }\n            if(res.data.code==10001) {\n              this.$message.error(res.data.msg)\n              router.push({\n                path: '/login',\n                query: {\n                  redirect: router.currentRoute.fullPath  // 防止从外部进来登录\n                }\n              })\n            }\n      })\n    },\n    addHistory(){\n      var history={\n        \"productId\":this.productId,\n        \"userId\":localStorage.getItem(\"userId\"),\n      }\n      axios.post(baseURL+\"/history/insert\",history)\n    },\n  },\n  mounted(){\n    console.log(this.productImgs)\n  }\n\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}